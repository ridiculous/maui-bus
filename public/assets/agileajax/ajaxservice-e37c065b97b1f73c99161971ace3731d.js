var AjaxService=function(t,e,i){function n(t,e,i){v.push({url:t,params:e,method:i})}function s(t){var e=[];if("string"==typeof t)return t;for(var i in t)e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e.join("&")}function c(t){return t>=200&&300>t}function a(t,e,i){x=!0;var n=s(e),c=[i,t,n].join("");if(E&&l[c])return d(c),!0;var a=w();a.onreadystatechange=u.bind(y,a,c),"get"==i.toLowerCase()&&n.length>0&&(t+="?"+n),a.open(i,t,!0),r(a),a.parameters=n,y.dispatchEvent("uninitialized",a),a.send(n),H&&o(a)}function o(t){t.timeout=setTimeout(h.bind(this,t),H)}function r(t){for(var e in f)t.setRequestHeader(e,f[e])}function u(t,e){var i=T[t.readyState];try{if("complete"==i&&(clearTimeout(t.timeout),x=!1,E&&!l[e]&&(l[e]=t)),this.dispatchEvent(i,t),"complete"==i&&c(t.status)?this.dispatchEvent("success",t):"complete"!=i||c(t.status)||this.dispatchEvent("failure",t),"complete"==i&&b&&v.length>0){var n=v.shift();a(n.url,n.params,n.method)}}catch(s){this.dispatchEvent("exception",s)}}function h(t){try{t.abort(),this.dispatchEvent("timeout",t)}catch(e){t.exception=e,this.dispatchEvent("exception",t)}}function d(t){var e=l[t];setTimeout(function(){try{y.dispatchEvent("complete",e),y.dispatchEvent("success",e)}catch(t){y.dispatchException("exception",e,t)}},50)}AjaxService.superclass.call(this,null);var p={},f={},l={},v=[],m="",y=this,x=!1,H=!1,E=!1,b=i,g=!1,T=["uninitialized","loading","loaded","interactive","complete"];this.registerEvents(["success","failure","exception","timeout"].concat(T)),this.setMethod=function(t){m=t,"POST"==m.toUpperCase()&&this.setRequestHeader("Content-type","application/x-www-form-urlencoded")},this.enableHistory=function(t){var e=this.createHistory(t);e.enable()},this.disableHistory=function(){var t=this.createHistory();t.disable()},this.createHistory=function(){return g||(g=new AjaxHistory(this),g.on("change",y.send)),g},this.enableCache=function(){E=!0},this.disableCache=function(){E=!1},this.setParams=function(t){p=t},this.setTimeout=function(t){H=t},this.setSynchronous=function(t){b=t},this.getTimeout=function(){return H},this.setRequestHeader=function(t,e){f[t]=e},this.send=function(e){b&&x?n(t,e||p,m):a(t,e||p,m)};var w=function(){try{return new XMLHttpRequest}catch(t){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){return new ActiveXObject("Microsoft.XMLHTTP")}}};this.setMethod(e||"POST"),this.getRawXHR=w};try{Class.extend(AjaxService,EventDispatcher)}catch(e){alert("Failed to extend class "+e.message)}