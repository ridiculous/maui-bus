function changeTimeFrame(){var e=this.rel,l=this.parentElement,t=l,a=l,i=Schedules[e];if(e){for(i||(i=new BusSchedule,i.init(e),Schedules[e]=i),l.className="active";a=a.nextSibling;)a.className="";for(;t=t.previousSibling;)t.className="";jUtils.hasClass(this,"morning")?i.toggleAM("table-cell").togglePM("none"):jUtils.hasClass(this,"afternoon")?i.toggleAM("none").togglePM("table-cell"):i.toggleAM("table-cell").togglePM("table-cell")}}var Schedules={},Toga=new Toggler;jUtils.addEvent(window,"load",function(){var e=jUtils.findByClass("time-list"),l=function(){if(document.getElementById(this.rel+"_container"))Toga.tableToggle.call(this);else{var e=this,l=this.rel.split("_"),t=l[0],a=l[1],i=document.createElement("div"),s=new AjaxService("/regions/"+t+"/routes/"+a+"/schedule","GET");i.innerHTML='<h5 class="loader">Loading ... </h5>',document.getElementById(this.rel).parentNode.appendChild(i),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.on("success",function(l){i.innerHTML=l.responseText,Toga.tableToggle.call(e),i=document.getElementById(e.rel+"_container");for(var t=0,a=i.childNodes[1].childNodes;t<a.length;t++){var s=a[t].childNodes[0];"active"==a[t].className&&changeTimeFrame.call(s),jUtils.addEvent(s,"click",changeTimeFrame)}}),s.send()}};if(jUtils.addEvent(e,"click",l),jUtils.addEvent(jUtils.findByClass("next-stop-list"),"click",Toga.nextStopsToggle),!document.getElementById("delay")){jUtils.addEvent(jUtils.findByClass("time-frame"),"click",changeTimeFrame);for(var t=0,a=jUtils.findByClass("active");t<a.length;t++)changeTimeFrame.call(a[t].childNodes[0])}for(var i=0,s=jUtils.findByClass("icon");i<s.length;i++)s[i].className+=" icon-white";if(window.location.hash)for(var n=0;n<e.length;n++)"#"+e[n].rel==window.location.hash&&Toga.tableToggle.call(e[n]);else 1===e.length&&Toga.tableToggle.call(e[0])});