function Maui(){var t=this;this.gmap=null,this.bus_stops=[],this.way_points=[],this.map_name="",this.centering=!1,this.loadBusStops=function(t){this.gmap||(this.gmap=new BaseMap),this.bus_stops=t;for(var e=0;e<t.length;e++)this[t[e].location]=t[e].name},this.drawRoute=function(e,n,i){if("undefined"!=typeof Center)this.centering=!0,this.centerMap();else{this.setWayPoints(i);var s={origin:e,destination:n,travelMode:google.maps.TravelMode.DRIVING,waypoints:this.way_points};this.gmap.directionsService.route(s,function(e,n){n==google.maps.DirectionsStatus.OK&&t.gmap.directionsDisplay.setDirections(e)}),this.gmap.addMarkers(this.bus_stops,this.map_name)}},this.setWayPoints=function(t){for(var e=0;e<t.length;e++){var n=null,i={};t[e]&&/:stopover/.test(t[e])?(n=this.bus_stops.findObject(t[e].split(":")[0],"location"),i.stopover=!1):n=this.bus_stops.findObject(t[e],"location"),i.location=new google.maps.LatLng(n.lat,n.long),this.way_points[e]=i}},this.setMapName=function(t){this.map_name=t},this.centerMap=function(t){var e=t||this.bus_stops.findObject(this[Center],"name"),n=new google.maps.LatLng(e.lat,e.long),i=this.gmap.addMarkers([e],this.map_name)[0];this.gmap.map.setCenter(n),this.gmap.map.setZoom(this.gmap.map.getZoom()+11),google.maps.event.trigger(i.marker,"click")},this.addQueenKaahumanuBack=function(){this.bus_stops.push({hidden:!0,lat:20.884325,"long":-156.476362,location:"queen_kaahumanu_back",name:"Back of Queen Kaahumanu"})}}function BaseMap(t){this.Mall=new google.maps.LatLng(20.88657,-156.475375),this.mapOptions=t||{zoom:7,mapTypeId:google.maps.MapTypeId.ROADMAP,center:this.Mall},this.map=new google.maps.Map(document.getElementById("map_canvas"),this.mapOptions),this.directionsService=new google.maps.DirectionsService,this.directionsDisplay=new google.maps.DirectionsRenderer({suppressMarkers:!0}),this.directionsDisplay.setMap(this.map),this.addMarkers=function(t,e){for(var n=[],i=e?e+"\n":"",s=0;s<t.length;s++)if(!t[s].hidden){var o={position:new google.maps.LatLng(t[s].lat,t[s].long),map:this.map,title:i+t[s].name},a=o.title.replace(/\n/,"<br />");t[s].times&&(a+="<br />"+t[s].times),n.push(new BaseMarker(this.map,o,a))}return n},this.addRoute=function(t){var e=new google.maps.DirectionsService,n=new google.maps.DirectionsRenderer({suppressMarkers:!0});n.setMap(this.map),e.route(t,function(t,e){e==google.maps.DirectionsStatus.OK&&n.setDirections(t)})}}function SearchMarker(t,e,n){var i=maui.gmap.map,s=new google.maps.Marker(e);google.maps.event.addListener(s,"click",function(){return info_window&&info_window.close(),this.title===last_stop?(last_stop="",void 0):(last_stop=this.title,info_window=new google.maps.InfoWindow({size:new google.maps.Size(150,50)}),info_window.setContent(n),info_window.open(i,s),jUtils.addEvent(jUtils.findByClass("destination"),"click",function(e){document.getElementById("destination").value=t,info_window.close(),e.stopPropagation()}),jUtils.addEvent(jUtils.findByClass("origin"),"click",function(e){document.getElementById("origin").value=t,info_window.close(),e.stopPropagation()}),void 0)})}Number.prototype.timesDo=function(t){if(t)for(var e=0;this>e;e++)t.call()},String.prototype.squeeze=function(){return this.replace(/\s+/g,"")},String.prototype.pluralize=function(t){var e="s";return 1==t&&(e=""),this+e},Array.prototype.compacted=function(){for(var t=[],e=0;e<this.length;e++)void 0!==this[e]&&null!==this[e]&&this[e]!==!1&&t.push(this[e]);return t},Array.prototype.find=function(t){for(var e=-1,n=0;n<this.length;n++)this[n]==t&&(e=n);return e},Array.prototype.findObject=function(t,e){for(var n=null,i=0;i<this.length;i++)this[i][e]==t&&(n=this[i]);return n},Array.prototype.updateObject=function(t,e,n,i){for(var s=0;s<this.length;s++)if(this[s][e]==i)return this[s][n]=i},Array.prototype.findAndRemove=function(t){for(var e=0;e<this.length;e++)this[e]==t&&this.splice(e,1)},Array.prototype.findAndRemoveObject=function(t,e){for(var n=0;n<this.length;n++)this[n]&&this[n][e]==t&&this.splice(n,1)};var info_window=null,last_stop="",jUtils={addEvent:function(t,e,n){var i=function(t){t.addEventListener?t.addEventListener(e,n):t.attachEvent?t.attachEvent("on"+e,function(){n.call(this.target||this.event.srcElement)}):t[e]=n};if("undefined"!=typeof t[0])for(var s=0;s<t.length;s++)i(t[s]);else i(t)},removeEvent:function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t[e]=null},findByClass:function(t){return document.getElementsByClassName?document.getElementsByClassName(t):document.querySelectorAll("."+t)},hasClass:function(t,e){return t.classList?t.classList.contains(e):-1!==t.className.split(/\s+/).find(e)},getEvent:function(t){return t?t:window.event}};if(!window.Prototype){Object.extend=function(t,e){for(var n in e)t[n]=e[n];return t};var $A=Array.from=function(t){if(!t)return[];if(t.toArray)return t.toArray();for(var e=[],n=0,i=t.length;i>n;n++)e.push(t[n]);return e};Function.prototype.bind=function(){var t=this,e=$A(arguments),n=e.shift();return function(){return t.apply(n,e.concat($A(arguments)))}};var Class={},Event={observe:function(t,e,n){try{t.addEventListener(e,n,!1)}catch(i){t.attachEvent("on"+e,n)}return t}}}Class.extend=function(t,e){return Object.extend(t.prototype,e.prototype),t.superclass=e,t};var EventDispatcher=function(){var t={},e=[];this.registerEvent=function(n){e.push(n),t[n]=[]},this.registerEvents=function(t){for(var e=0,n=t.length;n>e;e++)this.registerEvent(t[e])},this.getEventRoster=function(){return e},this.getListenerChain=function(){return t},this.addEventListener=function(e,n){return n instanceof Function?(t[e]?t[e].push(n):t[e]=[n],void 0):!1},this.hasEventListener=function(e){return"undefined"!=typeof t[e]&&t[e].length>0},this.removeEventListener=function(e,n){if(!this.hasEventListener(e))return!1;for(var i=0,s=t[e].length;s>i;i++)t[e][i]===n&&t[e].splice(i,1)},this.dispatchEvent=function(e,n){if(t[e])for(var i=0,s=t[e].length;s>i;i++)t[e][i](n)},this.once=function(t,e){var n=function(i){e(i),this.removeEventListener(t,n)}.bind(this);this.addEventListener(t,n)},this.on=this.addEventListener,this.un=this.removeEventListener,this.fire=this.dispatchEvent},AjaxService=function(t,e,n){function i(t,e,n){m.push({url:t,params:e,method:n})}function s(t){var e=[];if("string"==typeof t)return t;for(var n in t)e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")}function o(t){return t>=200&&300>t}function a(t,e,n){y=!0;var i=s(e),o=[n,t,i].join("");if(E&&f[o])return p(o),!0;var a=_();a.onreadystatechange=h.bind(g,a,o),"get"==n.toLowerCase()&&i.length>0&&(t+="?"+i),a.open(n,t,!0),c(a),a.parameters=i,g.dispatchEvent("uninitialized",a),a.send(i),w&&r(a)}function r(t){t.timeout=setTimeout(u.bind(this,t),w)}function c(t){for(var e in d)t.setRequestHeader(e,d[e])}function h(t,e){var n=L[t.readyState];try{if("complete"==n&&(clearTimeout(t.timeout),y=!1,E&&!f[e]&&(f[e]=t)),this.dispatchEvent(n,t),"complete"==n&&o(t.status)?this.dispatchEvent("success",t):"complete"!=n||o(t.status)||this.dispatchEvent("failure",t),"complete"==n&&b&&m.length>0){var i=m.shift();a(i.url,i.params,i.method)}}catch(s){this.dispatchEvent("exception",s)}}function u(t){try{t.abort(),this.dispatchEvent("timeout",t)}catch(e){t.exception=e,this.dispatchEvent("exception",t)}}function p(t){var e=f[t];setTimeout(function(){try{g.dispatchEvent("complete",e),g.dispatchEvent("success",e)}catch(t){g.dispatchException("exception",e,t)}},50)}AjaxService.superclass.call(this,null);var l={},d={},f={},m=[],v="",g=this,y=!1,w=!1,E=!1,b=n,M=!1,L=["uninitialized","loading","loaded","interactive","complete"];this.registerEvents(["success","failure","exception","timeout"].concat(L)),this.setMethod=function(t){v=t,"POST"==v.toUpperCase()&&this.setRequestHeader("Content-type","application/x-www-form-urlencoded")},this.enableHistory=function(t){var e=this.createHistory(t);e.enable()},this.disableHistory=function(){var t=this.createHistory();t.disable()},this.createHistory=function(){return M||(M=new AjaxHistory(this),M.on("change",g.send)),M},this.enableCache=function(){E=!0},this.disableCache=function(){E=!1},this.setParams=function(t){l=t},this.setTimeout=function(t){w=t},this.setSynchronous=function(t){b=t},this.getTimeout=function(){return w},this.setRequestHeader=function(t,e){d[t]=e},this.send=function(e){b&&y?i(t,e||l,v):a(t,e||l,v)};var _=function(){try{return new XMLHttpRequest}catch(t){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){return new ActiveXObject("Microsoft.XMLHTTP")}}};this.setMethod(e||"POST"),this.getRawXHR=_};try{Class.extend(AjaxService,EventDispatcher)}catch(e){alert("Failed to extend class "+e.message)}