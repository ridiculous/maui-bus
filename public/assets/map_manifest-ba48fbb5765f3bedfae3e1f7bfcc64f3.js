/**
 * Kind of like ruby's 3.times do .. end method
 * usage: (3).timesDo(function() {} );
 *
 * @param callback {function} to be called however many times
 */
function Maui(){var e=this;this.gmap=null,this.bus_stops=[],this.way_points=[],this.map_name="",this.centering=!1,this.loadBusStops=function(e){this.gmap||(this.gmap=new BaseMap),this.bus_stops=e;for(var t=0;t<e.length;t++)this[e[t].location]=e[t].name},this.drawRoute=function(t,n,r){if(typeof Center!="undefined")this.centering=!0,this.centerMap();else{this.setWayPoints(r);var i={origin:t,destination:n,travelMode:google.maps.TravelMode.DRIVING,waypoints:this.way_points};this.gmap.directionsService.route(i,function(t,n){n==google.maps.DirectionsStatus.OK&&e.gmap.directionsDisplay.setDirections(t)}),this.gmap.addMarkers(this.bus_stops,this.map_name)}},this.setWayPoints=function(e){for(var t=0;t<e.length;t++){var n=null,r={};e[t]&&/:stopover/.test(e[t])?(n=this.bus_stops.findObject(e[t].split(":")[0],"location"),r.stopover=!1):n=this.bus_stops.findObject(e[t],"location"),r.location=new google.maps.LatLng(n.lat,n.long),this.way_points[t]=r}},this.setMapName=function(e){this.map_name=e},this.centerMap=function(e){var t=e||this.bus_stops.findObject(this[Center],"name"),n=new google.maps.LatLng(t.lat,t.long),r=this.gmap.addMarkers([t],this.map_name)[0];this.gmap.map.setCenter(n),this.gmap.map.setZoom(this.gmap.map.getZoom()+11),google.maps.event.trigger(r.marker,"click")},this.addQueenKaahumanuBack=function(){this.bus_stops.push({hidden:!0,lat:20.884325,"long":-156.476362,location:"queen_kaahumanu_back",name:"Back of Queen Kaahumanu"})}}function BaseMap(e){this.Mall=new google.maps.LatLng(20.88657,-156.475375),this.mapOptions=e||{zoom:7,mapTypeId:google.maps.MapTypeId.ROADMAP,center:this.Mall},this.map=new google.maps.Map(document.getElementById("map_canvas"),this.mapOptions),this.directionsService=new google.maps.DirectionsService,this.directionsDisplay=new google.maps.DirectionsRenderer({suppressMarkers:!0}),this.directionsDisplay.setMap(this.map),this.addMarkers=function(e,t){var n=[],r=t?t+"\n":"";for(var i=0;i<e.length;i++)if(!e[i].hidden){var s={position:new google.maps.LatLng(e[i].lat,e[i].long),map:this.map,title:r+e[i].name},o=s.title.replace(/\n/,"<br />");e[i].times&&(o+="<br />"+e[i].times),n.push(new BaseMarker(this.map,s,o))}return n},this.addRoute=function(e){var t=new google.maps.DirectionsService,n=new google.maps.DirectionsRenderer({suppressMarkers:!0});n.setMap(this.map),t.route(e,function(e,t){t==google.maps.DirectionsStatus.OK&&n.setDirections(e)})}}function BaseMarker(e,t,n){var r=this;this.marker=new google.maps.Marker(t),google.maps.event.addListener(this.marker,"click",function(){var t=this.title.replace(/.+\n/,"");info_window&&info_window.close(),last_stop!==t?(last_stop=this.title.replace(/.+\n/,""),info_window=new google.maps.InfoWindow({size:new google.maps.Size(150,50)}),info_window.setContent(n),info_window.open(e,r.marker)):last_stop=""})}Number.prototype.timesDo=function(e){if(e)for(var t=0;t<this;t++)e.call()},String.prototype.squeeze=function(){return this.replace(/\s+/g,"")},String.prototype.pluralize=function(e){var t="s";return e==1&&(t=""),this+t},Array.prototype.compacted=function(){var e=[];for(var t=0;t<this.length;t++)this[t]!==undefined&&this[t]!==null&&this[t]!==!1&&e.push(this[t]);return e},Array.prototype.find=function(e){var t=-1;for(var n=0;n<this.length;n++)this[n]==e&&(t=n);return t},Array.prototype.findObject=function(e,t){var n=null;for(var r=0;r<this.length;r++)this[r][t]==e&&(n=this[r]);return n},Array.prototype.updateObject=function(e,t,n,r){for(var i=0;i<this.length;i++)if(this[i][t]==r)return this[i][n]=r},Array.prototype.findAndRemove=function(e){for(var t=0;t<this.length;t++)this[t]==e&&this.splice(t,1)},Array.prototype.findAndRemoveObject=function(e,t){for(var n=0;n<this.length;n++)this[n]&&this[n][t]==e&&this.splice(n,1)};var info_window=null,last_stop="";