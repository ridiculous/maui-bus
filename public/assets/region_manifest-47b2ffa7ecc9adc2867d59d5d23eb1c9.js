function StaticMap(){var e=this;this.$modal=document.getElementById("mba_modal"),this.$modal_body=document.getElementById("modal_body"),this.map_url="http://maps.googleapis.com/maps/api/staticmap?zoom=16&size=530x400&maptype=roadmap&sensor=false&markers=color:green%7C",this.init=function(){var t=this.rel,n=e.map_url;n+=t,n+="&center="+t,e.$modal_body.innerHTML='<img src="'+n+'" width="530" height="400" />',e.$modal.className="modal",setTimeout(function(){$.addEvent(document,"keyup",e.hideModalIf)},300)},this.hideModal=function(){$.removeEvent(document,"keyup",e.hideModalIf),e.$modal.className+=" fade",setTimeout(function(){e.$modal.className+=" hide"},500)},this.hideModalIf=function(t){27===$.getEvent(t).keyCode&&e.hideModal()}}function Toggler(){this.tableToggle=function(){var e=this.className.split(/\s+/),t=e.find("active"),n=this.rel,i=document.getElementById(n+"_container");return-1===t?(this.className+=" active",i.style.display="block"):(e.splice(t,1),this.className=e.join(" "),i.style.display="none"),!1},this.nextStopsToggle=function(){var e=this.className.split(/\s+/),t=e.find("active"),n=document.getElementById(this.rel);$.hasClass(n,"hidden-phone")?(this.className+=" active",n.className=""):(n.className="hidden-phone hidden-tablet",e.splice(t,1),this.className=e.join(" "))}}function BusSchedule(){this.schedule=[],this.route_name="",this.init=function(e){this.route_name=e;for(var t,n=document.getElementById(this.route_name+"_table"),i=0;t=n.rows[i];i++)for(var s,a=1;s=t.cells[a];a++){var l=a-1,o=s.innerHTML.replace(/\d+|\s+|:/g,"");this.schedule[l]||(this.schedule[l]=[]),o&&-1===this.schedule[l].find(o)&&this.schedule[l].push(o)}},this.toggleAM=function(e){return this.toggler("AM",e),this},this.togglePM=function(e){return this.toggler("PM",e),this},this.toggler=function(e,t){for(var n=0;n<this.schedule.length;n++)if(1===this.schedule[n].length&&this.schedule[n][0]===e)for(var i=0,s=$.findByClass(this.route_name+"-time-cell-"+n);i<s.length;i++)s[i].style.display=t}}function changeTimeFrame(){var e=this.rel,t=this.parentElement,n=t,i=t,s=Schedules[e];if(e){for(s||(s=new BusSchedule,s.init(e),Schedules[e]=s),t.className="active";i=i.nextSibling;)i.className="";for(;n=n.previousSibling;)n.className="";$.hasClass(this,"morning")?s.toggleAM("table-cell").togglePM("none"):$.hasClass(this,"afternoon")?s.toggleAM("none").togglePM("table-cell"):s.toggleAM("table-cell").togglePM("table-cell")}}Number.prototype.timesDo=function(e){if(e)for(var t=0;this>t;t++)e.call()},String.prototype.squeeze=function(){return this.replace(/\s+/g,"")},String.prototype.pluralize=function(e){var t="s";return 1==e&&(t=""),this+t},Array.prototype.compacted=function(){for(var e=[],t=0;t<this.length;t++)void 0!==this[t]&&null!==this[t]&&this[t]!==!1&&e.push(this[t]);return e},Array.prototype.find=function(e){for(var t=-1,n=0;n<this.length;n++)this[n]==e&&(t=n);return t},Array.prototype.findObject=function(e,t){for(var n=null,i=0;i<this.length;i++)this[i][t]==e&&(n=this[i]);return n},Array.prototype.updateObject=function(e,t,n,i){for(var s=0;s<this.length;s++)if(this[s][t]==i)return this[s][n]=i},Array.prototype.findAndRemove=function(e){for(var t=0;t<this.length;t++)this[t]==e&&this.splice(t,1)},Array.prototype.findAndRemoveObject=function(e,t){for(var n=0;n<this.length;n++)this[n]&&this[n][t]==e&&this.splice(n,1)};var $={addEvent:function(e,t,n){var i=function(e){e.addEventListener?e.addEventListener(t,n):e.attachEvent?e.attachEvent("on"+t,function(){n.call(this.target||this.event.srcElement)}):e[t]=n};if("undefined"!=typeof e[0])for(var s=0;s<e.length;s++)i(e[s]);else i(e)},removeEvent:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e[t]=null},findByClass:function(e){return document.getElementsByClassName?document.getElementsByClassName(e):document.querySelectorAll("."+e)},hasClass:function(e,t){return e.classList?e.classList.contains(t):-1!==e.className.split(/\s+/).find(t)},getEvent:function(e){return e?e:window.event}},Schedules={},Toga=new Toggler;$.addEvent(window,"load",function(){var e=$.findByClass("time-list");$.addEvent(e,"click",Toga.tableToggle),$.addEvent($.findByClass("next-stop-list"),"click",Toga.nextStopsToggle),$.addEvent($.findByClass("time-frame"),"click",changeTimeFrame);for(var t=0,n=$.findByClass("active");t<n.length;t++)changeTimeFrame.call(n[t].childNodes[0]);for(var i=0,s=$.findByClass("icon");i<s.length;i++)s[i].className+=" icon-white";if(window.location.hash)for(var a=0;a<e.length;a++)"#"+e[a].rel==window.location.hash&&Toga.tableToggle.call(e[a]);else 1===e.length&&Toga.tableToggle.call(e[0])});